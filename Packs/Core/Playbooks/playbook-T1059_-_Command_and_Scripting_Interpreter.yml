id: T1059 - Command and Scripting Interpreter
version: -1
name: T1059 - Command and Scripting Interpreter
description: "This playbook handles command and scripting interpreter alerts based on the MITRE T1059 technique.\nAn attacker might abuse command and script interpreters to execute commands, scripts, or binaries.\nMost systems come with some kind of built-in command line interface and scripting capabilities. For example, macOS and Linux distributions include some form of Unix Shell while Windows installations include the Windows Command Shell and PowerShell.\n\n\n**Attacker's Goals:**\n\nAn attacker can abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in initial access payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. An attacker may also execute commands through interactive terminals/shells, as well as utilize various remote services to achieve remote execution.\n\n**Analysis**\n\nDue to the nature of this technique and the usage of built-in command line interfaces, the first step of the playbook is to analyze the command line. \nThe command line analysis does the following:\n- Checks and decodes base64\n- Extracts and enriches indicators from the command line\n- Checks specific arguments for malicious usage \n\n**Investigative Actions:**\nThe playbook checks for additional activity using the 'Endpoint Investigation Plan' playbook and utilizes the power of insight alerts.\n\n**Response Actions**\n\nAfter analyzing the data, the playbook's first response action is to contain the threat based on the initial data provided within the alert. In this phase, the playbook will:\n\n* Isolate the endpoint based on playbook inputs.\n\nWhen the playbook proceeds, it checks for additional activity using the 'Endpoint Investigation Plan' playbook. It then continues with the next stage, which includes, containment and eradication.\n\nThis phase executes the following containment actions:\n\n* Automatically isolates the endpoint\n\nIt then continues with the following eradication actions:\n\n* process termination"
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 8b8374a2-b79d-46de-861d-12bd94d694c8
    type: start
    task:
      id: 8b8374a2-b79d-46de-861d-12bd94d694c8
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: d689d797-b627-4ed4-8db8-f702fddf7aac
    type: title
    task:
      id: d689d797-b627-4ed4-8db8-f702fddf7aac
      version: -1
      name: Analysis
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 72fbd013-1f55-4324-827e-a293884788f3
    type: title
    task:
      id: 72fbd013-1f55-4324-827e-a293884788f3
      version: -1
      name: 'Containment '
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 8463fb6b-e649-4464-85e1-fa2497f81c27
    type: title
    task:
      id: 8463fb6b-e649-4464-85e1-fa2497f81c27
      version: -1
      name: Finding
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 22432c3e-f618-4556-8544-4695c8054471
    type: condition
    task:
      id: 22432c3e-f618-4556-8544-4695c8054471
      version: -1
      name: Manual review - was it your security vendor?
      description: |+
        Check the script that ran and verify:
        Was it your security vendor? Was it a script from your IT, or a known file?


      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "14"
      "Yes":
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 800,
          "y": 930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 4ddb3c79-cf4a-4ab8-8e26-dc5cd72e8c04
    type: regular
    task:
      id: 4ddb3c79-cf4a-4ab8-8e26-dc5cd72e8c04
      version: -1
      name: close alert
      description: Closes the alert in Cortex XSIAM
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      closeReason:
        simple: Resolved - Threat Handled
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 2940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 1c926e27-0fd5-4b60-82e4-3ab7bec929c9
    type: title
    task:
      id: 1c926e27-0fd5-4b60-82e4-3ab7bec929c9
      version: -1
      name: Investigation
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 7122ef49-4fec-412a-86da-2f6fc9563561
    type: title
    task:
      id: 7122ef49-4fec-412a-86da-2f6fc9563561
      version: -1
      name: 'Remediation '
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "42"
      - "52"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: e16a8da7-de95-4894-83f9-c9bc38ff52e2
    type: condition
    task:
      id: e16a8da7-de95-4894-83f9-c9bc38ff52e2
      version: -1
      name: Should restore affected endpoint?
      description: Checks if it should release the affected endpoint from isolation.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "34"
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.AutoRestoreEndpoint
            iscontext: true
          right:
            value:
              simple: "True"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 800,
          "y": 2415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 1c0c3418-1dc3-4ddf-85b7-2eaf744cca18
    type: title
    task:
      id: 1c0c3418-1dc3-4ddf-85b7-2eaf744cca18
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: c56ccf1c-62e0-4bdc-8889-5ecf8f419c4f
    type: condition
    task:
      id: c56ccf1c-62e0-4bdc-8889-5ecf8f419c4f
      version: -1
      name: Should close alert automatically?
      description: Whether to close the alert automatically or manually.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "29"
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.ShouldCloseAutomatically
            iscontext: true
          right:
            value:
              simple: "True"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 800,
          "y": 2770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 7e128208-4a6e-4e8f-81b5-d9998af64a8a
    type: condition
    task:
      id: 7e128208-4a6e-4e8f-81b5-d9998af64a8a
      version: -1
      name: 'Found any malicious behavior? '
      description: Checks if found malicious behavior.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "16"
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: CommandlineVerdict
            iscontext: true
          right:
            value: {}
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 2650ee91-e541-4332-8cf9-8b27bef073fe
    type: playbook
    task:
      id: 2650ee91-e541-4332-8cf9-8b27bef073fe
      version: -1
      name: Eradication Plan
      description: |-
        This playbook handles all the eradication actions available with Cortex XSIAM.
        The playbook allows you to eradicate the incident with one of the following tasks:
        * Reset user password
        * Delete file
        * Kill process (currently, the playbook supports terminating a process by name).

        The playbook inputs allows you to manipulate the execution flow, please pay attention to the inputs description.
      playbookName: Eradication Plan
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      AutoEradicate:
        simple: "false"
      EndpointID:
        complex:
          root: alert
          accessor: agentid
      FilePath:
        complex:
          root: foundIncidents.CustomFields
          accessor: initiatorpath
      FileRemediation:
        simple: Quarantine
      Username:
        complex:
          root: foundIncidents.CustomFields
          accessor: username
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 2100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 9af50b8b-6d3d-4e0b-8a19-57762adb934a
    type: playbook
    task:
      id: 9af50b8b-6d3d-4e0b-8a19-57762adb934a
      version: -1
      name: Recovery Plan
      description: |-
        This playbook handles all the recovery actions available with Cortex XSIAM.
        The playbook allows to recover  from the incident with one of the following tasks:
        * Unisolate endpoint
        * Restore quarantined file

        The playbook inputs allows you to manipulate the execution flow, please pay attention to the inputs description.
      playbookName: Recovery Plan
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
      - "34"
    scriptarguments:
      endpointID:
        complex:
          root: alert
          accessor: agentid
      releaseFile:
        simple: "false"
      unIsolateEndpoint:
        simple: "true"
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 2590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: c65f44a3-7339-4023-85d9-730440543e30
    type: playbook
    task:
      id: c65f44a3-7339-4023-85d9-730440543e30
      version: -1
      name: Handle False Positive Alerts
      description: |
        This playbook handles false positive alerts.
      playbookName: Handle False Positive Alerts
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      FileSHA256:
        complex:
          root: alert
          accessor: initiatorsha256
      ShouldCloseAutomatically:
        complex:
          root: inputs.ShouldCloseAutomatically
      alertName:
        complex:
          root: alert
          accessor: name
      sourceIP:
        complex:
          root: alert
          accessor: hostip
      username:
        complex:
          root: alert
          accessor: username
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: f1ec4e84-79d8-481f-8c34-0a5b410936f9
    type: playbook
    task:
      id: f1ec4e84-79d8-481f-8c34-0a5b410936f9
      version: -1
      name: Command-Line Analysis
      playbookName: Command-Line Analysis
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      CommandLine:
        complex:
          root: inputs.CommandLine
          transformers:
          - operator: uniq
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 59741944-c3f6-4930-8594-53cec6875f48
    type: condition
    task:
      id: 59741944-c3f6-4930-8594-53cec6875f48
      version: -1
      name: Found relevant information?
      description: Checks whether relevant information is found.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: foundIncidents
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 6c84da37-0652-422c-83a2-04aef82d9021
    type: title
    task:
      id: 6c84da37-0652-422c-83a2-04aef82d9021
      version: -1
      name: Recovery
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "28"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 800,
          "y": 2270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 96e29aab-f376-49f4-84cb-a30e569261de
    type: playbook
    task:
      id: 96e29aab-f376-49f4-84cb-a30e569261de
      version: -1
      name: Endpoint Investigation Plan
      description: |-
        This playbook handles all the endpoint investigation actions available with Cortex XSIAM.
        The playbook allows you to investigate and hunt for more information using one of the following tasks:
        * Pre-defined MITRE Tactics
        * Host fields (Host ID)
        * Attacker fields (Attacker IP, External host)
        * MITRE techniques
        * File hash (currently, the playbook supports only SHA256)

        The playbook inputs allows you to manipulate the execution flow, please pay attention to the inputs description.
      playbookName: Endpoint Investigation Plan
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "48"
    scriptarguments:
      HuntCnCTechniques:
        simple: "True"
      HuntCollectionTechniques:
        simple: "True"
      HuntDefenseEvasionTechniques:
        simple: "True"
      HuntDiscoveryTechniques:
        simple: "True"
      HuntExecutionTechniques:
        simple: "True"
      HuntImpactTechniques:
        simple: "True"
      HuntInitialAccessTechniques:
        simple: "True"
      HuntLateralMovementTechniques:
        simple: "True"
      HuntPersistenceTechniques:
        simple: "True"
      HuntPrivilegeEscalationTechniques:
        simple: "True"
      HuntReconnaissanceTechniques:
        simple: "True"
      agentID:
        complex:
          root: alert
          accessor: agentid
      timeRange:
        simple: 24 hours ago
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: fb3b753b-416e-4a5d-8e72-cda87f3469e7
    type: playbook
    task:
      id: fb3b753b-416e-4a5d-8e72-cda87f3469e7
      version: -1
      name: Containment Plan
      description: |-
        This playbook handles all the containment actions available with XSIAM.
        The playbook allows to contain the incident with one of the following tasks:
        * Isolate endpoint
        * Disable account
        * Quarantine file
        * Block indicators
        * Clear user session (currently, the playbook supports only Okta)

        The playbook inputs allows you to manipulate the execution flow, please pay attention to the inputs description.
      playbookName: Containment Plan
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      AutoContainment:
        complex:
          root: inputs.AutoContainment
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "true"
      BlockIndicators:
        simple: "True"
      ClearUserSessions:
        simple: "False"
      Domain:
        complex:
          root: ExtractedIndicators
          accessor: Domain
      EndpointID:
        complex:
          root: alert
          accessor: agentid
      FileContainment:
        simple: "False"
      FileRemediation:
        simple: Quarantine
      HostAutoContainment:
        complex:
          root: inputs.PreHostContainment
      IAMUserDomain:
        simple: '@demisto.com'
      IP:
        complex:
          root: ExtractedIndicators
          accessor: IP
      URL:
        complex:
          root: ExtractedIndicators
          accessor: URL
      UserContainment:
        simple: "False"
    separatecontext: true
    loop:
      iscommand: false
      scriptArguments:
        AutoContainment:
          complex:
            root: inputs.AutoContainment
            transformers:
            - operator: SetIfEmpty
              args:
                applyIfEmpty: {}
                defaultValue:
                  value:
                    simple: "true"
        BlockIndicators:
          simple: "True"
        ClearUserSessions:
          simple: "False"
        EndpointID:
          complex:
            root: alert
            accessor: agentid
        FileContainment:
          simple: "True"
        FileHash:
          complex:
            root: alert
            filters:
            - - operator: isNotEqualString
                left:
                  value:
                    simple: alert.initiatorpath
                  iscontext: true
                right:
                  value:
                    simple: c:\windows\explorer.exe
                ignorecase: true
            accessor: initiatorsha256
            transformers:
            - operator: SetIfEmpty
              args:
                applyIfEmpty: {}
                defaultValue:
                  value:
                    simple: alert.targetprocesssha256
                  iscontext: true
        FilePath:
          complex:
            root: alert.initiatorpath
            filters:
            - - operator: isNotEqualString
                left:
                  value:
                    simple: alert.initiatorpath
                  iscontext: true
                right:
                  value:
                    simple: c:\windows\explorer.exe
                ignorecase: true
            transformers:
            - operator: SetIfEmpty
              args:
                applyIfEmpty: {}
                defaultValue:
                  value:
                    simple: alert.targetprocesscmd
                  iscontext: true
            - operator: replaceMatch
              args:
                regex:
                  value:
                    simple: \"
                replaceWith: {}
            - operator: uniq
        FileRemediation:
          simple: Quarantine
        HostAutoContainment:
          simple: "false"
        IAMUserDomain:
          simple: '@demisto.com'
        UserContainment:
          simple: "False"
        Username:
          complex:
            root: alert
            accessor: username
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1140,
          "y": 1250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 478be987-29c6-4b0d-8a92-247a466ada2f
    type: playbook
    task:
      id: 478be987-29c6-4b0d-8a92-247a466ada2f
      version: -1
      name: Containment Plan
      description: |-
        This playbook handles all the containment actions available with XSIAM.
        The playbook allows to contain the incident with one of the following tasks:
        * Isolate endpoint
        * Disable account
        * Quarantine file
        * Block indicators
        * Clear user session (currently, the playbook supports only Okta)

        The playbook inputs allows you to manipulate the execution flow, please pay attention to the inputs description.
      playbookName: Containment Plan
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      AutoContainment:
        complex:
          root: inputs.AutoContainment
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "false"
      BlockIndicators:
        simple: "True"
      ClearUserSessions:
        simple: "False"
      EndpointID:
        complex:
          root: alert
          accessor: agentid
      FileContainment:
        simple: "True"
      FileHash:
        complex:
          root: foundIncidents.CustomFields
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: foundIncidents.CustomFields.initiatorpath
                iscontext: true
              right:
                value:
                  simple: c:\windows\explorer.exe
              ignorecase: true
          accessor: initiatorsha256
      FilePath:
        complex:
          root: foundIncidents.CustomFields.initiatorpath
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: foundIncidents.CustomFields.initiatorpath
                iscontext: true
              right:
                value:
                  simple: c:\windows\explorer.exe
              ignorecase: true
          transformers:
          - operator: uniq
      FileRemediation:
        complex:
          root: inputs.FileRemediation
      HostAutoContainment:
        complex:
          root: inputs.HostAutoContainment
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: "false"
      UserContainment:
        simple: "False"
    separatecontext: true
    loop:
      iscommand: false
      scriptArguments:
        AutoContainment:
          complex:
            root: inputs.AutoContainment
            transformers:
            - operator: SetIfEmpty
              args:
                applyIfEmpty: {}
                defaultValue:
                  value:
                    simple: "false"
        BlockIndicators:
          simple: "True"
        ClearUserSessions:
          simple: "False"
        EndpointID:
          complex:
            root: alert
            accessor: agentid
        FileContainment:
          simple: "True"
        FileHash:
          complex:
            root: foundIncidents.CustomFields
            filters:
            - - operator: isNotEqualString
                left:
                  value:
                    simple: foundIncidents.CustomFields.initiatorpath
                  iscontext: true
                right:
                  value:
                    simple: c:\windows\explorer.exe
                ignorecase: true
            accessor: initiatorsha256
        FilePath:
          complex:
            root: foundIncidents.CustomFields.initiatorpath
            filters:
            - - operator: isNotEqualString
                left:
                  value:
                    simple: foundIncidents.CustomFields.initiatorpath
                  iscontext: true
                right:
                  value:
                    simple: c:\windows\explorer.exe
                ignorecase: true
            transformers:
            - operator: uniq
        FileRemediation:
          complex:
            root: inputs.FileRemediation
        HostAutoContainment:
          complex:
            root: inputs.HostAutoContainment
        IAMUserDomain:
          simple: '@demisto.com'
        UserContainment:
          simple: "False"
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1580,
          "y": 2100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "16_14_No": 0.52,
      "16_44_Yes": 0.53,
      "28_34_#default#": 0.51,
      "28_43_yes": 0.43,
      "34_29_#default#": 0.25,
      "39_14_yes": 0.5,
      "39_16_#default#": 0.46,
      "48_27_yes": 0.62,
      "48_49_#default#": 0.47
    },
    "paper": {
      "dimensions": {
        "height": 3075,
        "width": 1510,
        "x": 450,
        "y": 100
      }
    }
  }
inputs:
- key: ShouldCloseAutomatically
  value:
    simple: "False"
  required: false
  description: ""
  playbookInputQuery:
- key: AutoRestoreEndpoint
  value:
    simple: "False"
  required: false
  description: Whether to execute the Recovery playbook.
  playbookInputQuery:
- key: AutoContainment
  value: {}
  required: false
  description: "Whether to execute automatically or manually the containment plan tasks:\n* Block indicators\n* Quarantine file\n* Disable user "
  playbookInputQuery:
- key: PreHostContainment
  value:
    simple: "True"
  required: false
  description: Isolate the host after the Analysis phase (command-line analysis)
  playbookInputQuery:
- key: FileRemediation
  value: {}
  required: false
  description: ""
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.6.0
